{
	"$schema": "http://json-schema.org/draft-07/schema#",
	"definitions": {

		"oId": {
			"type": "object",
			"properties": {
				"id": {"type": "string", "format": "uri"},
				"desc": {"type": "string"},
				"docRefs":{
					"type": "array",
					"items": {"type": "string", "format": "uri"},
				 	"minItems": 1
				}
			},
			"required": ["id"]
		},
		
		"pkiOb": {
			"type": "object",
			"properties":{
				"encoding": {"type": "string", "format": "uri"},
				"specRef": {"type": "string"},
				"val": {"type": "string", "contentEncoding" : "base64"}
			},
			"required": ["val"]
		},
        
		"tstToken":{
		 	"type": "object",
			"properties":{
				"type": {"type": "string"},
				"encoding": {"type": "string", "format": "uri"},
				"specRef": {"type": "string"},
				"val": {"type": "string", "contentEncoding" : "base64"}
			},
			"required": ["val"]
		},
		
		"tstContainer":{
			"type": "object",
			"properties": {
				"canonAlg": {"type": "string", "format": "uri"},
				"tstokens": {
					"type": "array",
					"items": {"$ref":"#/definitions/tstToken"}
				}
			},
			"required": ["tstokens"]
		},

		"sigT": {"type": "string", "format": "date-time"},
		
		"x5t#o": {
			"type": "object",
			"properties": {
				"digAlg": {"type": "string"},
				"digVal": {"type": "string", "contentEncoding": "base64"}
			},
			"required": ["digAlg","digVal"]
		},
		
		"digAlgVal": {
			"type": "object",
			"properties": {
				"digAlg": {"type": "string"},
				"digVal": {"type": "string", "contentEncoding": "base64"}
			},
			"required": ["digAlg","digVal"]
		},

		"sigX5ts": {
			"type": "array",
			"items": {"$ref": "#/definitions/x5t%23o"},
			"minItems": 2
		},

		"srCms":{
			"type": "array",
			"items": {
				"type": "object",
				"properties":{
					"commId": {"$ref": "#/definitions/oId"},
					"commQuals":{
						"type": "array",
						"items": {"type":"object"}
					}
				},
				"required": ["commId"]
			}
		},

		"sigPl":{
			"type": "object",
			"properties":{
				"addressCountry": {"type": "string"},
				"addressLocality": {"type": "string"},
				"addressRegion": {"type": "string"},
				"postOfficeBoxNumber": {"type": "string"},
				"postalCode": {"type": "string"},
				"streetAddress": {"type": "string"}
			},
			"minProperties": 1
		},

		"qArrays":{
			"type": "array",
			"items": {
				"type": "object",
				"properties": {
					"mediaType": {"type": "string"},
					"encoding": {"type": "string"},
					"vals": {
						"type": "array",
						"minItems": 1
					}
				},
				"required": [ "mediaType", "encoding", "vals" ],
				"minItems": 1
			}
		},

		"srAts":{
			"type": "object",
			"properties": {
				"certified":{
					"type": "array",
					"items": {"$ref": "#/definitions/certifiedAttrs"},
					"minItems": 1
				},
				"claimed": {"$ref": "#/definitions/qArrays"},
				"signedAssertions": {"$ref": "#/definitions/qArrays"}
			},
			"minProperties": 1
		},
		
		"certifiedAttrs": {
			"type": "object",
			"oneOf":[
				{
					"properties": {
						"x509AttrCert":{
							"type": "object",
							"properties": {
								"val": {"type": "string", "contentEncoding" : "base64"}
							},
							"required": ["val"]
						}
					},
					"required": [ "x509AttrCert" ]
				},
				{
					"properties": {
						"otherAttrCert": {"$ref": "#/definitions/pkiOb"}
					},
					"required": [ "otherAttrCert" ]
				}
			]
		},

		"adoTst": {"$ref": "#/definitions/tstContainer"},

		"sigPId": {
			"type": "object",
			"properties": {
				"id": {"$ref": "#/definitions/oId"},
				"hashAV": {"$ref": "#/definitions/digAlgVal"},
				"hashPSp": {"type": "boolean"},
				"sigPQuals": {
		 			"type": "array",
					"minItems": 1
				}
		 	},
			"required": ["id"]
		},

		"spURI": {"type": "string", "format": "uri"},
		
		"spUserNotice": {
			"type": "object",
			"properties": {
				"noticeRef": {
					"type": "object",
					"properties": {
						"organization": {"type": "string"},
						"noticeNumbers": {
							"type": "array",
							"items": {"type": "integer"},
							"minItems" : 1
		 				}
					}
				},
				"explText": {"type": "string"}
			},
			"minProperties": 1
		},

		"spDSpec": {"$ref": "#/definitions/oId"},

		"sigD":{ 
			"type": "object",
			"properties": {
				"mId" : {"type":"string", "format": "uri"},
				"pars" : {
					"type": "array",
					"items": {"type": "string"},
		                        "minItems": 1
				},
				"hashM" : {"type":"string"},
				"hashV" : {
					"type": "array",
					"items": {"type": "string"},
		                        "minItems": 1
				},
				"ctys" : {
					"type": "array",
					"items": {"type": "string"},
		                        "minItems": 1
				}
			},
			"required": ["mId"]
		},

		"etsiU": {
			"type": "array",
			"minItems": 1
		},

		"sigPSt": {
			"oneOf": [
				{
					"type": "object",
					"properties": {
						"sigPolDoc": {"type": "string", "contentEncoding": "base64"}
					}
				},
				{
					"type": "object",
					"properties": {
						"sigPolLocalURI": {"type": "string", "format": "uri-reference"}
					}
				}
			],
			"type":"object",
			"properties":{
				"spDSpec": {"$ref": "#/definitions/oId"}
		 	},
			"minProperties": 1
		},

		"sigTst": {"$ref": "#/definitions/tstContainer"},
		
		"xVals": {
			"type": "array",
			"items": {
				"oneOf": [
		 			{
		 				"properties": {
		 					"x509Cert": {"$ref": "#/definitions/pkiOb"}
		 				},
		 				"required": ["x509Cert"]
		 			},
		 			{
		 				"properties": {
		 					"otherCert": {"$ref": "#/definitions/pkiOb"}
		 				},
		 				"required": ["otherCert"]
		 			}
				]
			},
			"minItems": 1
		},
		
		"rVals": {
			"type": "object",
			"properties":{
				"crlVals": {
					"type": "array",
					"items": {"$ref":"#/definitions/pkiOb"},
					"minItems": 1
				},
				"ocspVals": {
					"type": "array",
					"items": {"$ref":"#/definitions/pkiOb"},
					"minItems": 1
				},
				"otherVals": {
					"type": "array",
					"items": {"type":"object"},
					"minItems": 1
				}
			},
			"minProperties": 1
		},

		"axVals": {"$ref": "#/definitions/xVals"},		
		
		"arVals": {"$ref": "#/definitions/rVals"},

		"tstVD": {
			"type": "object",
			"properties": {
				"certVals": {"$ref": "#/definitions/xVals"},
				"revVals": {"$ref": "#/definitions/rVals"},
				"onJWSP": {"type": "boolean"}
			},
			"minProperties": 1
		},

		"arcTst": {
			"type": "object",
			"properties": {
				"tstContainer": {"$ref": "#/definitions/tstContainer"},
				"timeStamped": {
					"type": "string",
					"enum": ["all", "previousArcTst"]
				}
			}
		},

		"certId":{
			"type": "object",
			"properties":{
				"digAlgVal": {"$ref": "#/definitions/digAlgVal"},
				"kid": {"type": "string", "contentEncoding" : "base64"},
				"x5u": {"type": "string", "format": "uri-reference"}
			},
			"required": ["digAlgVal"]
		},
		
		"x5Ids": {
			"type": "array",
			"items": {"$ref": "#/definitions/certId"},
			"minItems": 1
		},
		
		"xRefs": {"$ref": "#/definitions/x5Ids"},

		"rRefs": {
			"type": "object",
			"properties": {
				"crlRefs": {
					"type": "array",
					"items": {
						"type": "object",
						"properties": {
							"digAlgVal": {"$ref": "#/definitions/digAlgVal"},
							"crlId": {
								"type": "object",
								"properties": {
									"issuer": {"type": "string", "contentEncoding" : "base64"},
									"issueTime": {"type": "string", "format": "date-time"},
									"number": {"type": "number"},
									"uri": {"type": "string", "format": "uri-reference"}
								},
								"required": ["issuer","issueTime"]
							}
						},
						"required": ["digAlgVal"]
					},
					"minItems": 1
				},
				"ocspRefs":{
					"type": "array",
					"items": {
						"type": "object",
						"properties": {
							"ocspId": {
								"type": "object",
								"properties": {
									"responderId": {
										"oneOf":	[
											{"byName": {"type": "string", "contentEncoding" : "base64"}},
											{"byKey": {"type": "string", "contentEncoding" : "base64"}}
										]
									},
									"producedAt": {"type": "string", "format": "date-time"},
									"uri": {"type": "string", "format": "uri-reference"}
								},
								"required": ["responderId", "producedAt"]
							},
							"digAlgVal": {"$ref": "#/definitions/digAlgVal"}
						},
						"required": ["ocspId","digAlgVal"]
					},
					"minItems": 1
				},
				"otherRefs": {
					"type": "array",
					"items": {"type":"object"},
					"minItems": 1
				}
			},
			"minProperties": 1
		},

		"axRefs": {"$ref": "#/definitions/x5Ids"},

		"arRefs": {"$ref": "#/definitions/x5Ids"},

		"rfsTst": {"$ref": "#/definitions/tstContainer"},
		
		"sigRTst": {"$ref": "#/definitions/tstContainer"}

	}
}